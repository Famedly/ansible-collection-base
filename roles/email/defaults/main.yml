#general vars
email_tld: famedly.de
email_domain: "{{ email_tld }}"
email_hostname: "ratzupaltuff-test.{{ email_domain }}"
email_base_path: "/opt/email"
email_group_name: "email"
email_docker_network_name: "email"
email_network_prefix: "172.3.0"
email_network_gateway: "{{ email_network_prefix }}.1"
email_network: "{{ email_network_prefix }}.0/24"
email_local_send_network: "{{ email_network }}"

#postfix
postfix_user_name: postfix #TODO do not run as root #already used in main.cf mail owner
postfix_config_files:
  - main.cf
  - master.cf
postfix_docker_name: postfix
postfix_docker_hostname: "{{ postfix_docker_name }}"
postfix_docker_image: registry.gitlab.com/famedly/company/devops/containers/email/postfix
postfix_docker_ports: ['0.0.0.0:25:25']
  #- 0.0.0.0:25:25

  # - 2500:25
        #  - 587:587
        #  - 465:465
        #  - 1587:1587 #smtp for dovecot
postfix_docker_labels: {} #override e.g. for traefik

postfix_base_path: "{{ email_base_path }}/postfix"
postfix_container_spool_path: /var/spool/postfix
postfix_container_config_path: /etc/postfix

postfix_smtpd_milters: 25 #dkim signed emails are sent there
postfix_smtpd_milters_ip: "{{ email_network_prefix }}.4" #todo automate that #currently not used

#postfix_sender_networks: "{{ email_network }}" #, 127.0.0.0/24" #comma separated

#dovecot
dovecot_user_name: vmail
dovecot_base_path: "{{ email_base_path }}/dovecot"
dovecot_docker_name: dovecot
dovecot_docker_image: registry.gitlab.com/famedly/company/devops/containers/email/dovecot
dovecot_docker_ports: 
#  - 110:110 #pop3
  - 143:143 #imap
  - 993:993 #imap secure
#  - 995:993 #pop3 secure
dovecot_docker_labels: {}

#rspamd
#rspamd_group_name: rspamd
rspamd_user_name: rspamd
rspamd_docker_name: rspamd
rspamd_docker_hostname: "{{ rspamd_docker_name }}"
rspamd_docker_image: registry.gitlab.com/famedly/company/devops/containers/email/rspamd
rspamd_docker_ports: #[]
  - 127.0.0.1:8080:11334
rspamd_docker_labels: {}

#rspamd_listening_address: "{{ email_network_prefix }}.1" #v4 for any v4 interface
#rspamd_listening_address: "172.3.0.5" #v4 for any v4 interface
rspamd_listening_address: "rspamd" #v4 for any v4 interface
rspamd_milter_listening_port: "11332"

rspamd_host_base_path: "{{ email_base_path }}/rspamd"
rspamd_docker_conf_path: "/etc/rspamd"
rspamd_docker_static_runtime_data_path: "/var/lib/rspamd" #*.hs, *.hsmp, *.map files in here get recreated every start and do not have to be backed up
rspamd_dkim_location_host: "{{ rspamd_host_base_path }}/dkim"
rspamd_dkim_location_container: "/var/lib/rspamd/dkim"
rspamd_docker_volumes:
  - "{{ rspamd_host_base_path }}/static_runtime_data/:{{ rspamd_docker_static_runtime_data_path }}:rw"
  - "{{ rspamd_host_base_path }}/control_socket/:/run/rspamd:rw"
  - "{{ rspamd_dkim_location_host }}/:{{ rspamd_dkim_location_container }}/:ro"
rspamd_install_redis: true

#DKIM
#dkim_selector_name: ratzupaltuff-test #dkim #hostname or month/year
dkim_selector_name: dkim
#dkim_cert_filename: "{{ dkim_selector_name }}.key.pem"
